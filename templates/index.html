{% extends "base.html" %}
{% load static %}

{% block content %}
<body>
  <header class="topbar">
    <div class="container">
      <div class="logo">
        <h1>StreamAdvisor</h1>
        <span class="beta-tag">Suggestix</span>
      </div>
      <nav>
        <a href="{% url 'dashboard' %}">Explorar</a>
        <a href="{% url 'favorites' %}">Favoritos</a>
        <a href="{% url 'settings' %}">Preferencias</a>
        <div class="user-section">
            <button id="loginBtn" class="login-btn" onclick="redirectToLogin()">
              <a href="{% url 'login' %}">Iniciar sesiÃ³n</a>
            </button>
            <button id="loginBtn" class="login-btn" onclick="redirectToRegister()">
              <a href="{% url 'register' %}">Registrarse</a>
            </button>
          </div>          
        </div>
      </nav>
    </div>
  </header>

  <main class="container">
    <section class="hero">
      <div class="hero-content">
        <h2>Encuentra tu prÃ³ximo favorito</h2>
        <p>Recomendaciones personalizadas de pelÃ­culas, series y libros con tecnologÃ­a de machine learning.</p>
        <div class="hero-actions">
          <a class="btn btn-primary" href="{% url 'dashboard' %}">Comenzar a explorar</a>
          <a class="btn btn-secondary" href="{% url 'settings' %}">Configurar preferencias</a>
          <a href="{% url 'login' %}" class="btn btn-outline"><span>ğŸ”</span> Iniciar SesiÃ³n</a>
          <a href="{% url 'register' %}" class="btn btn-primary"><span>ğŸš€</span> Crear Cuenta</a>
        </div>
        
        <!-- EstadÃ­sticas en tiempo real -->
        <div class="live-stats">
          <div class="stat-item">
            <span class="stat-number" id="userCount">1,247</span>
            <span class="stat-label">usuarios activos</span>
          </div>
          <div class="stat-item">
            <span class="stat-number" id="contentCount">8,956</span>
            <span class="stat-label">tÃ­tulos disponibles</span>
          </div>
          <div class="stat-item">
            <span class="stat-number" id="matchRate">94%</span>
            <span class="stat-label">tasa de acierto</span>
          </div>
        </div>
      </div>
      <div class="hero-visual">
        <div class="content-preview">
          <div class="preview-item movie">ğŸ¬</div>
          <div class="preview-item series">ğŸ“º</div>
          <div class="preview-item book">ğŸ“š</div>
        </div>
        
        <!-- Badge de recomendaciones personalizadas -->
        <div class="personalization-badge">
          <div class="badge-icon">âœ¨</div>
          <div class="badge-content">
            <strong>Recomendaciones 100% personalizadas</strong>
            <span>Basadas en tus gustos y preferencias</span>
          </div>
        </div>
      </div>
    </section>

    <section class="features">
      <h2>Â¿Por quÃ© StreamAdvisor?</h2>
      <div class="features-grid">
        <div class="feature-card">
          <div class="feature-icon">ğŸ¤–</div>
          <h3>Algoritmos inteligentes</h3>
          <p>Nuestro sistema de recomendaciÃ³n aprende de tus preferencias para ofrecerte contenido relevante.</p>
          <div class="feature-stats">
            <span class="stat">+94% de precisiÃ³n</span>
          </div>
        </div>
        <div class="feature-card">
          <div class="feature-icon">ğŸ”</div>
          <h3>BÃºsqueda avanzada</h3>
          <p>Encuentra rÃ¡pidamente lo que buscas con nuestro motor de bÃºsqueda potenciado por Elasticsearch.</p>
          <div class="feature-stats">
            <span class="stat">BÃºsqueda en 0.2s</span>
          </div>
        </div>
        <div class="feature-card">
          <div class="feature-icon">ğŸ“±</div>
          <h3>Multiplataforma</h3>
          <p>Disfruta de StreamAdvisor en todos tus dispositivos con nuestra aplicaciÃ³n React Native.</p>
          <div class="feature-stats">
            <span class="stat">3 plataformas</span>
          </div>
        </div>
        <div class="feature-card">
          <div class="feature-icon">ğŸ¯</div>
          <h3>Recomendaciones precisas</h3>
          <p>Sistema de puntuaciÃ³n avanzado que considera mÃºltiples factores para cada recomendaciÃ³n.</p>
          <div class="feature-stats">
            <span class="stat">5 factores clave</span>
          </div>
        </div>
        <div class="feature-card">
          <div class="feature-icon">âš¡</div>
          <h3>Actualizaciones en tiempo real</h3>
          <p>Tu perfil se actualiza instantÃ¡neamente con cada interacciÃ³n para mejorar las recomendaciones.</p>
          <div class="feature-stats">
            <span class="stat">Tiempo real</span>
          </div>
        </div>
        <div class="feature-card">
          <div class="feature-icon">ğŸ›¡ï¸</div>
          <h3>Privacidad garantizada</h3>
          <p>Tus datos estÃ¡n seguros con nosotros. Cumplimos con los mÃ¡s altos estÃ¡ndares de seguridad.</p>
          <div class="feature-stats">
            <span class="stat">100% seguro</span>
          </div>
        </div>
      </div>
    </section>

    <section class="quick-actions">
      <h2>Comienza tu experiencia</h2>
      <p class="section-description">Elige cÃ³mo quieres empezar a descubrir contenido increÃ­ble</p>
      
      <div class="actions-grid">
        <div class="action-card">
          <div class="action-icon">ğŸš€</div>
          <h3>Explorar contenido</h3>
          <p>Descubre pelÃ­culas, series y libros recomendados especÃ­ficamente para ti.</p>
          <a class="btn btn-primary" href="{% url 'dashboard' %}">Explorar ahora</a>
          <div class="action-tip">
            <span>ğŸ’¡ Basado en tendencias globales</span>
          </div>
        </div>
        <div class="action-card">
          <div class="action-icon">âš™ï¸</div>
          <h3>Personalizar preferencias</h3>
          <p>Configura tus gÃ©neros favoritos para obtener recomendaciones mÃ¡s precisas.</p>
          <a class="btn btn-secondary" href="{% url 'settings' %}">Configurar ahora</a>
          <div class="action-tip">
            <span>ğŸ¯ Mejora tu experiencia</span>
          </div>
        </div>
        <div class="action-card">
          <div class="action-icon">ğŸ”</div>
          <h3>Ãšnete a la comunidad</h3>
          <p>Crea una cuenta para guardar favoritos y obtener recomendaciones personalizadas.</p>
          <div class="auth-action-buttons">
            <button class="btn btn-primary" onclick="redirectToRegister()">
              <span>ğŸŒŸ</span>
              <a href="{% url 'register' %}">Crear Cuenta</a>
            </button>
            <button class="btn btn-outline" onclick="redirectToLogin()">
              <a href="{% url 'login' %}">Ya tengo cuenta</a>
            </button>
          </div>
          <div class="action-tip">
            <span>âœ¨ Experiencia completa</span>
          </div>
        </div>
      </div>
    </section>

    <!-- Nueva secciÃ³n: Trending Now -->
    <section class="trending-section">
      <h2>Trending Now</h2>
      <p class="section-description">Lo que otros usuarios estÃ¡n descubriendo ahora mismo</p>
      
      <div class="trending-grid">
        <div class="trending-item">
          <div class="trending-badge">ğŸ”¥ Trending</div>
          <div class="trending-content">
            <h4>CÃ³digo Alfa</h4>
            <p>Serie Â· Ciencia ficciÃ³n</p>
            <div class="trending-stats">
              <span>â­ 4.5</span>
              <span>ğŸ‘¥ 1.2k vistas</span>
            </div>
          </div>
        </div>
        <div class="trending-item">
          <div class="trending-badge">ğŸ¬ Nuevo</div>
          <div class="trending-content">
            <h4>Luz de Medianoche</h4>
            <p>PelÃ­cula Â· Drama</p>
            <div class="trending-stats">
              <span>â­ 4.2</span>
              <span>ğŸ‘¥ 894 vistas</span>
            </div>
          </div>
        </div>
        <div class="trending-item">
          <div class="trending-badge">ğŸ“š Popular</div>
          <div class="trending-content">
            <h4>El Sendero de los SueÃ±os</h4>
            <p>Libro Â· FantasÃ­a</p>
            <div class="trending-stats">
              <span>â­ 4.7</span>
              <span>ğŸ‘¥ 2.1k vistas</span>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Nueva secciÃ³n: Testimonios -->
    <section class="testimonials-section">
      <h2>Lo que dicen nuestros usuarios</h2>
      <p class="section-description">Descubre cÃ³mo StreamAdvisor estÃ¡ transformando la forma de encontrar contenido</p>
      
      <div class="testimonials-grid">
        <div class="testimonial-card">
          <div class="testimonial-content">
            <div class="stars">â­â­â­â­â­</div>
            <p>"StreamAdvisor encontrÃ³ exactamente lo que me gusta. Â¡Las recomendaciones son increÃ­blemente precisas!"</p>
          </div>
          <div class="testimonial-author">
            <div class="author-avatar">ğŸ‘©â€ğŸ’¼</div>
            <div class="author-info">
              <strong>MarÃ­a GonzÃ¡lez</strong>
              <span>Usuaria desde 2023</span>
            </div>
          </div>
        </div>
        
        <div class="testimonial-card">
          <div class="testimonial-content">
            <div class="stars">â­â­â­â­â­</div>
            <p>"Finalmente una app que entiende mis gustos. He descubierto joyas que nunca hubiera encontrado por mi cuenta."</p>
          </div>
          <div class="testimonial-author">
            <div class="author-avatar">ğŸ‘¨â€ğŸ’»</div>
            <div class="author-info">
              <strong>Carlos RodrÃ­guez</strong>
              <span>Usuaria desde 2023</span>
            </div>
          </div>
        </div>
        
        <div class="testimonial-card">
          <div class="testimonial-content">
            <div class="stars">â­â­â­â­â­</div>
            <p>"La interfaz es intuitiva y las recomendaciones mejoran cada dÃ­a. Â¡Imprescindible para cualquier amante del entretenimiento!"</p>
          </div>
          <div class="testimonial-author">
            <div class="author-avatar">ğŸ‘©â€ğŸ“</div>
            <div class="author-info">
              <strong>Ana MartÃ­nez</strong>
              <span>Usuaria desde 2023</span>
            </div>
          </div>
        </div>
      </div>
    
    <section class="cta-section" id="ctaSection">
      <div class="cta-content">
        <h2>Â¿Listo para descubrir contenido increÃ­ble?</h2>
        <p>Ãšnete a miles de usuarios que ya estÃ¡n disfrutando de recomendaciones personalizadas</p>
        <div class="cta-buttons">
          <button class="btn btn-primary btn-large" onclick="redirectToRegister()">
            <span>ğŸš€</span>
            <a href="{% url 'register' %}">Crear Cuenta Gratis</a>
          </button>
          <button class="btn btn-outline btn-large" onclick="redirectToLogin()">
            <span>ğŸ”</span>
            <a href="{% url 'login' %}">Iniciar SesiÃ³n</a>
          </button>
        </div>
        <div class="cta-features">
          <span>âœ… Sin compromiso</span>
          <span>âœ… ConfiguraciÃ³n en 2 minutos</span>
          <span>âœ… Recomendaciones inmediatas</span>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <div class="container">
      <div class="footer-content">
        <div class="footer-info">
          <h3>StreamAdvisor - Suggestix</h3>
          <p>Tu guÃ­a personalizada de entretenimiento</p>
          <p class="tech-stack">Desarrollado con React Native, Node.js, PostgreSQL y Elasticsearch</p>
          
          <!-- Redes sociales -->
          <div class="social-links">
            <a href="#" class="social-link">ğŸ“˜ Facebook</a>
            <a href="#" class="social-link">ğŸ¦ Twitter</a>
            <a href="#" class="social-link">ğŸ“· Instagram</a>
            <a href="#" class="social-link">ğŸ’¼ LinkedIn</a>
          </div>
        </div>
        
        <div class="footer-links-grid">
          <div class="footer-links-column">
            <h4>Producto</h4>
            <a href="{% url 'dashboard' %}">Explorar</a>
            <a href="{% url 'favorites' %}">Favoritos</a>
            <a href="{% url 'settings' %}">Preferencias</a>
            <a href="#">API</a>
          </div>
          
          <div class="footer-links-column">
            <h4>CompaÃ±Ã­a</h4>
            <a href="#">Sobre nosotros</a>
            <a href="#">Blog</a>
            <a href="#">Carreras</a>
            <a href="#">Contacto</a>
          </div>
          
          <div class="footer-links-column">
            <h4>Legal</h4>
            <a href="#">TÃ©rminos de servicio</a>
            <a href="#">PolÃ­tica de privacidad</a>
            <a href="#">Cookies</a>
            <a href="#">Soporte</a>
          </div>
          
          <div class="footer-links-column">
            <h4>Plataformas</h4>
            <a href="#">iOS App</a>
            <a href="#">Android App</a>
            <a href="#">Web</a>
            <a href="#">Smart TV</a>
          </div>
        </div>
      </div>
      
      <div class="footer-newsletter">
        <div class="newsletter-content">
          <h4>ğŸ“§ Mantente actualizado</h4>
          <p>Recibe las Ãºltimas recomendaciones y novedades en tu email</p>
        </div>
        <div class="newsletter-form">
          <input type="email" placeholder="tu@email.com" class="newsletter-input">
          <button class="btn btn-primary">Suscribirse</button>
        </div>
      </div>
      
      <p class="copyright">Prototipo funcional - StreamAdvisor SpA &copy; 2023 Â· Hecho con â¤ï¸ para amantes del entretenimiento</p>
    </div>
  </footer>

  <script src="{% static 'js/app.js' %}"></script>
  
  <!-- Script adicional para funcionalidades especÃ­ficas del index -->
  <script>
  // Funciones de redirecciÃ³n
  function redirectToLogin() {
    window.location.href = 'login.html';
  }

  function redirectToRegister() {
    window.location.href = 'register.html';
  }

  // Animaciones para estadÃ­sticas en tiempo real
  function animateCounter(element, target, duration = 2000) {
    let start = 0;
    const increment = target / (duration / 16);
    const timer = setInterval(() => {
      start += increment;
      if (start >= target) {
        element.textContent = target.toLocaleString();
        clearInterval(timer);
      } else {
        element.textContent = Math.floor(start).toLocaleString();
      }
    }, 16);
  }

  // Inicializar animaciones cuando la pÃ¡gina carga
  document.addEventListener('DOMContentLoaded', function() {
    // Animar contadores
    const userCount = document.getElementById('userCount');
    const contentCount = document.getElementById('contentCount');
    
    if (userCount) animateCounter(userCount, 1247);
    if (contentCount) animateCounter(contentCount, 8956);
    
    // Efecto de escritura para el match rate
    const matchRate = document.getElementById('matchRate');
    if (matchRate) {
      let current = 0;
      const target = 94;
      const interval = setInterval(() => {
        current += 2;
        matchRate.textContent = current + '%';
        if (current >= target) {
          matchRate.textContent = target + '%';
          clearInterval(interval);
        }
      }, 50);
    }
    
    // Efecto de parpadeo para el avatar si no hay usuario
    const userAvatar = document.getElementById('userAvatar');
    if (userAvatar && !getUser()) {
      setInterval(() => {
        userAvatar.style.boxShadow = userAvatar.style.boxShadow ? 
          '' : '0 0 20px rgba(59, 130, 246, 0.5)';
      }, 1000);
    }

    // Actualizar visibilidad de botones de autenticaciÃ³n
    updateAuthButtonsVisibility();
  });

  // FunciÃ³n para obtener usuario (desde app.js)
  function getUser() {
    return JSON.parse(localStorage.getItem('user') || 'null');
  }

  // Actualizar visibilidad de botones de autenticaciÃ³n
  function updateAuthButtonsVisibility() {
    const user = getUser();
    const authButtons = document.getElementById('authButtons');
    const authHeroButtons = document.getElementById('authHeroButtons');
    const ctaSection = document.getElementById('ctaSection');
    
    if (user) {
      // Usuario logueado - ocultar botones de autenticaciÃ³n
      if (authButtons) authButtons.style.display = 'none';
      if (authHeroButtons) authHeroButtons.style.display = 'none';
      if (ctaSection) ctaSection.style.display = 'none';
    } else {
      // Usuario no logueado - mostrar botones de autenticaciÃ³n
      if (authButtons) authButtons.style.display = 'flex';
      if (authHeroButtons) authHeroButtons.style.display = 'flex';
      if (ctaSection) ctaSection.style.display = 'block';
    }
  }
  </script>
  <!-- Incluir el sistema de base de datos -->
<script src="database.js"></script>
<script src="auth.js"></script>

<script>
// Inicializar y verificar autenticaciÃ³n
document.addEventListener('DOMContentLoaded', async function() {
    await checkAuthentication();
    updateUIForAuthentication(!!getCurrentSession());
});
</script>
</body>
{% endblock content %}